<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="./common/images/favicon.svg" sizes="any">
<title>tools</title>
<link rel="stylesheet" href="./common/css/reset.css">
<link rel="stylesheet" href="./common/css/style.css?testd">
<link rel="stylesheet" href="./common/css/modal.css?test">
<link rel="stylesheet" href="./common/css/tools.css?testd">
<style>
#calc {
  max-width: 100%;
  margin: 0 auto;
}    
#calc th{
  width:26%;
}
#calc td:nth-child(2){
  width:37%;
}
#calc td:nth-child(3){
  width:35%;
}
.result{
    font-size:30px;
    display: flex;
}
.ruby3{
    font-size:18px;
    height:30px;
    padding-top:0;;
    padding-bottom:20px;
} 

.number{
  width: 80px!important;
}
.sign{
  width: 50px;
  line-height: 50px;
  font-size:2rem;
  margin: 0 10px;
}
.option{
  display:flex;
  line-height: 30px;
}
.decimal{
  width: 40px !important;
}
</style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="header__inner">
        <h1 class="header__title header-title">
          <a href="index.html">★ Roku tools </a>
        </h1>

        <nav class="header__nav nav" id="js-nav" style="vertical-align: top;">
          <ul class="nav__items nav-items">
            <li class="nav-items__item"><a href="calc.html">計算ツール</a></li>
            <li class="nav-items__item"><a href="timer.html">タイマー</a></li>
            <li class="nav-items__item"><a href="reversi.html">オセロ</a></li>
            <li class="nav-items__item"><a href="memory.html">神経衰弱</a></li>
            <li class="nav-items__item"><a href="flash.html">フラッシュ暗算</a></li>
            <li class="nav-items__item"><a href="watch.html">ストップウォッチ</a></li>
            <li class="nav-items__item"><a href="prime.html">素数パズル</a></li>
            <li class="nav-items__item"><a href="maketen.html">テンパズル</a></li>
            <li class="nav-items__item"><a href="bmi.html">bmi</a></li>
            <li class="nav-items__item"><a href="maze.html">迷路</a></li>
            <li class="nav-items__item"><a href="tools.html">ツール</a></li>
          </ul>
        </nav>
        <button class="header__hamburger hamburger" id="js-hamburger">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </header>
    <main>
      <div class="btn" id="test" >test</div>
      <p>Paste your image here…</p>
      <!-- <div width="100%">       -->
        <!-- <img id="container"/> -->
        <canvas width="600px" height="500px%" id="mycanvas" style="background-color: red;"></canvas>

      <!-- </div> -->
    
    </main>       
</div><!-- container -->
<script src="./common/js/jquery-3.6.3.min.js"></script>
<script src="./common/js/jquery-ui.js"></script>
<script src="./common/js/common.js"></script>
<script src="./common/js/tools.js?tesat"></script>
<!-- <script src="./common/js/calc.js?tesat"></script> -->

<script>
'use strict';
$(function(){
//   document.onpaste = function(pasteEvent) {
//     //最初のアイテムを検討します(複数のアイテムに簡単に拡張できます)
//     var item = pasteEvent.clipboardData.items[0];
//     let container = $('#container');
 
//     if (item.type.indexOf("image") === 0)    {
//         var blob = item.getAsFile();
//         var reader = new FileReader();
//         reader.onload = function(event) {
//           container.attr('src', event.target.result);
//             // document.getElementById("container").src = event.target.result;
//         };
 
//         reader.readAsDataURL(blob);
//         console.log(item);
//         container.css('width', '100%');
//         // itme.style.width=100;
//     }
// }


 // canvas準備
 const board = document.querySelector("#mycanvas");  //getElementById()等でも可。オブジェクトが取れれば良い。
  const ctx = board.getContext("2d");

  // 画像読み込み
  const chara = new Image();
  chara.src = "./common/images/sample.jpg";  // 画像のURLを指定
  chara.onload = () => {
    ctx.drawImage(chara, 0, 0);
  }




document.onpaste = function(pasteEvent) {
    imagePaste( pasteEvent );
    return false;
  }
  function imagePaste( event ){
  var blobimg = null;
  var items = ( event.clipboardData || event.originalEvent.clipboardData ).items;
  for( var i = 0; i < items.length; i ++ ){
    if( items[i].type.indexOf( "image" ) == 0 ){
      blobimg = items[i].getAsFile();
    }
  }

  if( blobimg != null ){
    var bloburl = URL.createObjectURL( blobimg );

    var canvas = document.getElementById( "mycanvas" );
    var ctx = canvas.getContext( '2d' );

    var img = new Image();
    img.src = bloburl;
    img.onload = function(){
      var sw = img.naturalWidth;
      var sh = img.naturalHeight;
      var dw = canvas.width;
      var dh = canvas.height;
      ctx.drawImage( img, 0, 0, sw, sh, 0, 0, dw, dh );
    };
  }
}

$('#test').click(function(){
  // test(255,132,70);
  // test(254,149,110);
  // test(235,165,126);
  // test(59,52,47);
  test();
})


function test() {
    var canvas = document.getElementsByTagName("canvas")[0];
    // const canvas = document.querySelector("#mycanvas");  //getElementById()等でも可。オブジェクトが取れれば良い。

    var context = canvas.getContext("2d");
    var imageData = context.getImageData(0, 0, canvas.width, canvas.height);

    let r, g, b;
    for(var i = 0; i < (imageData.width*imageData.height); i++) {
      r = imageData.data[i*4];
      g = imageData.data[i*4+1];
      b = imageData.data[i*4+2];
      

      // if((r==255 && g==132 && b==70)||
      //   (r==254 && g==149 && b==110)||
      //   (r==253 && g==165 && b==126)){
      //     imageData.data[i*4] = 255;
      //     imageData.data[i*4+1] = 255;
      //     imageData.data[i*4+2] = 255;
      //     imageData.data[i*4+3] = 0.5;
      //     console.log(r, g, b);

      // }

      if((r>=235 && r<=255)||
        (g>=130 && g<=200)||
        (b>=50 && b<=225)){
          imageData.data[i*4] = 255;
          imageData.data[i*4+1] = 255;
          imageData.data[i*4+2] = 255;
          imageData.data[i*4+3] = 0.5;
          console.log(r, g, b);

      }
      imageData.data[i*4] = 255;
          imageData.data[i*4+1] = 255;
          imageData.data[i*4+2] = 255;
          imageData.data[i*4+3] = 0.5;

      // console.log(123,imageData.data[i*4], imageData.data[i*4+1], imageData.data[i*4+2]);
      //   if((imageData.data[i*4] == r) &&
      //      (imageData.data[i*4+1] == g) &&
      //      (imageData.data[i*4+2] == b)) {
      //       // imageData.data[i*4+3] = 0;
      //       console.log(456,imageData.data[i*4], imageData.data[i*4+1], imageData.data[i*4+2]);
      //       imageData.data[i*4] = 255;
      //       imageData.data[i*4+1] = 255;
      //       imageData.data[i*4+2] = 255;
      //       imageData.data[i*4+3] = 0.5;


      //   }
        // if((imageData.data[i*4] >=230 && imageData.data[i*4]<=255) &&
        //    (imageData.data[i*4+1] >=253 && imageData.data[i*4+1] == g) &&
        //    (imageData.data[i*4+2] >=253 && imageData.data[i*4+2] == b)) {
        //     imageData.data[i*4] = 255;
        //     imageData.data[i*4+1] = 255;
        //     imageData.data[i*4+2] = 255;
        //     imageData.data[i*4+3] = 0.5;


        // }
    }
    context.putImageData(imageData, 0, 0);
    return;
}
})
</script>
</body>
</html> 
