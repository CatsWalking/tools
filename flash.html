<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="./common/images/favicon.svg" sizes="any">
<title>Roku.tools|フラッシュ暗算</title>
<link rel="stylesheet" href="./common/css/reset.css">
<link rel="stylesheet" href="./common/css/style.css?test">
<link rel="stylesheet" href="./common/css/modal.css?test">
<link rel="stylesheet" href="./common/css/tools.css?test">
<style>

#tab_edu a{
    padding:5px 0 ;
}
.tab_label{
    display: inline-block; width:55px;font-size: 0.8rem;
}
.tenkey_box{
    background:#ecf9f0;
}
#question{
  background:#DCE7F2;
  font-size:4rem;
}
#question {
  height: 100px;
  line-height: 100px;
  background: #ecf9f0;
  text-align: center;
  display: table-cell;
  width: 98%;
  letter-spacing: 1rem;
}

/* PC */
@media screen and (min-width: 960px) {
  #question {
    height: 120px;
  }
}
#answer{
  color:rgb(20, 179, 55);
  font-size: 3rem;
}
.tenkey_box li{
  height: 50px;
  font-size: 1.8rem; 
}
.status{
    min-width: 40px;
}
#howto{
    line-height: 2.4rem;
}
#howto td{
    padding:0;
    text-align:left;
    font-size: 0.9rem;
}
.conf div{
    background:none;
    border:1px solid rgba(0, 172, 239, 0.3);
    cursor: auto;
}
.box.-l{
    width:48px;
    height:48px;
}
</style>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DP1WEV1PRZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('conf', 'G-DP1WEV1PRZ');
</script>
<body>
  <div class="container">
    <header></header>
    <main>
        <div id="start_message">タップしてスタート</div>
    <!-- HOWTO -->
    <div id="howto">
        <p style="font-size: 3rem;margin:20px;">flash</p> 
        <!-- レベル -->
        <p>レベル、スピード、回数 を選んでスタート！</p> 
        <table style="width:350px;margin: 20px auto;padding:0;">
            <tr><td width="60">レベル</td>
                <td class="tab_level">
                    <div class="status">1</div>
                    <div class="status -green">2</div>
                    <div class="status">3</div>
                    <div class="status">4</div>
                    <div class="status">5</div>
                </td>
            </tr>
            <tr><td>スピード</td>
                <td class="tab_speed">
                    <div class="status">1</div>
                    <div class="status -green">2</div>
                    <div class="status">3</div>
                    <div class="status">4</div>
                    <div class="status">5</div>
                </td>
            </tr>
            <tr><td>回数</td>
                <td class="tab_times">
                    <div class="status">3</div>
                    <div class="status -green">5</div>
                    <div class="status">10</div>
                    <div class="status">15</div>
                    <div class="status">20</div>
                </td>
            </tr>
            <tr><td width="60"><img src="./common/images/icon/beginner.png" class="icon -sss"></td>
                <td class="radioarea txtLeft">
                    <label class="-checked"><input type="radio" name="display_help" value="1" checked>ヒント表示する</label>
                    <label><input type="radio" name="display_help" value="0">ヒント表示しない</label>
                </td>
            </tr>
        </table>
        <!-- スタート -->
        <div class="btn js_start">スタート</div>
        <hr>
        <div class="txtS mtb20" style="line-height:1.6rem;">※ 検定・大会問題等の<br>問題出力方法・作問規定 とは異なります</div>
        <div>
            <ul style="line-height: 1.6rem;width:150px;text-align:left;margin: 10px auto;">
                <li>level 1: 5 〜 20</li>
                <li>level 2: 10 〜 50</li>
                <li>level 3: 10 〜 100</li>
                <li>level 4: 101 〜 200</li>
                <li>level 5: 201 〜 1000</li>
            </ul>
            <ul style="line-height: 1.6rem;width:150px;text-align:left;margin: 10px auto;">
                <li>speed 1: 1800sec </li>
                <li>speed 2: 1500sec </li>
                <li>speed 3: 1300sec </li>
                <li>speed 4: 1000sec </li>
                <li>speed 5: 500sec </li>
            </ul>
        </div>
      </div>
       <!-- OK -->
        <div class="outer">
        <div id="ok_sign">
          <img src="./common/images/animals/kuma04.png" width="200">
          <p>OK</p>
        </div>
      </div>
<!-- ヘッダ -->
<div class="header_box">
    <div id="timer" class="timer">0.00</div>
    <div id="cnt"><span id="current_cnt">1</span> / <span id="all_cnt">5</span></div>
    <div><img src="./common/images/icon/beginner.png" class="icon -ss" id="display_help"></div>
    <div><img src="./common/images/icon/close.png" class="icon -ss js_quit"></div>
  </div>
  <div class="btn_box conf">
        <span class="tab_label">レベル</span>
        <div class="status level_1">1</div>
        <div class="status level_2">2</div>
        <div class="status level_3">3</div>
        <div class="status level_4">4</div>
        <div class="status level_5">5</div>
    </div>
    <div class="btn_box conf">
        <span class="tab_label">スピード</span>
        <div class="status speed_1">1</div>
        <div class="status speed_2">2</div>
        <div class="status speed_3">3</div>
        <div class="status speed_4">4</div>
        <div class="status speed_5">5</div>
    </div>
    <div class="btn_box conf">
        <span class="tab_label">回数</span>
        <div class="status times_3">3</div>
        <div class="status times_5">5</div>
        <div class="status times_10">10</div>
        <div class="status times_15">15</div>
        <div class="status times_20">20</div>
    </div>
    <div class="outer mt20"><div id="question"></div></div>
    <div class="outer" style="width:98%;text-align: center;"><div id="help"></div></div>
    <div class="outer" style="width:98%;text-align: center;"><div id="answer"></div></div>
    </main>
    <!-- footer -->
  <footer>
    <!-- kenkey -->
    <table width="100%">
        <tr>
          <td rowspan="3">
            <ul class="tenkey_box -column3">
                <li>1</li>
                <li>2</li>
                <li>3</li>
                <li>4</li>
                <li>5</li>
                <li>6</li>
                <li>7</li>
                <li>8</li>
                <li>9</li>
                <li>0</li>
            </ul>
          </td>
          <td style="text-align:center;width: 60px !important; height:50px;">
            <div id="js_clear" class="box -l">×</div>
          </td>
        </tr>
        <tr>
          <td rowspan="2" style="text-align:center;">
            <div id="js_ok">GO</div>
          </td>
        </tr>
      </table>
  </footer>
</div><!-- container -->
<script src="./common/js/jquery-3.6.3.min.js"></script>
<script src="./common/js/jquery-ui.js"></script>
<script src="./common/js/common.js?tesdssast"></script>
<script src="./common/js/modal.js?tesdst"></script>
<script src="./common/js/tools.js?tedsst"></script>
<script>
// https://keisanginou.jimdofree.com/%E3%83%95%E3%83%A9%E3%83%83%E3%82%B7%E3%83%A5%E6%9A%97%E7%AE%97/
'use strict'
$(function(){
const levels = {1:{'min':5,'max':20}, 
            2:{'min':10,'max':50},
            3:{'min':10,'max':100},
            4:{'min':101,'max':200},
            5:{'min':201,'max':1000}};
const speeds = {1:1800,2:1500,3:1000,4:800,5:500}
let conf = {level:2, speed:2, times:5};


//-------------------------
// RokuToolを継承
//-------------------------
class myRokuTool extends RokuTool{

    constructor() {
        super(conf)

        // ヘルプタップしたら、答えをこっそり表示
        $('#help').click((e)=>{
            this.showAnswer(e);
        })
    }

    //-------------------------
    // 指定回数分の設問を作成して配列に入れておく
    //-------------------------
    generateQuestions = () =>{
        let rnd_arr = [];
        let rnd;
        // 指定の数分、乱数を生成（かぶらないように）
        for(let i=0; i<conf.times; i++){
            rnd_arr = [];
            while (Object.keys(rnd_arr).length < conf.times) {
                rnd = rand(levels[conf.level].min, levels[conf.level].max);
                // 存在しなかったら追加(level1&count=10は、数がかぶりすぎてスタックする)
                if (rnd_arr.indexOf(rnd) == -1 || (conf.level == 0 && conf.times > 5)) {
                    rnd_arr.unshift(rnd);
                }
            }
            this.questions[i] = rnd_arr;
        }
    }

    //-------------------------
    // 設問セット
    //-------------------------
    setQuestion = ()=>{
        this.correct = 0;
        $('#current_cnt').html(this.current+1);
        $('#ok_sign').removeClass('fadeUp');
        $('#ok_sign').css('display', 'none');
        if(this.timer.isRunning){
            let num;
            // １回目は即表示
            num = this.questions[this.current][0];
            $('#question').html(num);
            this.correct += parseInt(num)
            let counter = 1;
            // ２回目以降指定のspeedごとに
            let q_time_id = setInterval(()=> {
            if (counter < this.conf.times) {
                num = this.questions[this.current][counter];
                $('#question').html(num);
                counter++;
                this.correct += parseInt(num)
            } else {
                clearInterval(q_time_id);
                clearInterval(this.help_timer_id);
                this.help_timer_id = '';
                // 2秒後に式(help)を表示
                this.help_timer_id = window.setTimeout(()=>{
                    $('#help').html(this.questions[this.current].join(' + '));
                }, 2000)
            }
            }, speeds[this.conf.speed]);
        }
    }

    // 判定
    judge = ()=>{
        return (parseInt(this.answer) == parseInt(this.correct));
    }

    //-------------------------
    // tenkey
    tenkey = (e)=>{
        this.answer = this.answer + String($(e.currentTarget).html());
        $('#answer').html(this.answer);
    }

    // ヘルプタップしたら、答えをこっそり表示
    showAnswer = (e)=>{
        if(this.correct!='' && $('#help').html()!='' && isActive($('#display_help')) && $(e.currentTarget).html().indexOf('=')==-1){
            $('#help').html( $('#help').html()+' = ' + parseInt(this.correct))
        }
    }
}
//-------------------------
// RokuTool インスタンス
//-------------------------
myRokuTool = new myRokuTool(conf);
// timer
myRokuTool.timer = new Timer($('#timer'));
myRokuTool.useKeyboard = false;


})
</script>
</body>
</html> 