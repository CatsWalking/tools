<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="./common/images/favicon.svg" sizes="any">
<title>tools</title>
<link rel="stylesheet" href="./common/css/reset.css">
<link rel="stylesheet" href="./common/css/style.css?testd">
<link rel="stylesheet" href="./common/css/modal.css?test">
<link rel="stylesheet" href="./common/css/tools.css?testd">
<style>
#calc {
  max-width: 100%;
  margin: 0 auto;
}    
#calc th{
  width:26%;
}
#calc td:nth-child(2){
  width:37%;
}
#calc td:nth-child(3){
  width:35%;
}
.result{
    font-size:30px;
    display: flex;
}
.ruby3{
    font-size:18px;
    height:30px;
    padding-top:0;;
    padding-bottom:20px;
} 

.number{
  width: 80px!important;
}
.sign{
  width: 20px;
  line-height: 50px;
  font-size:2rem;
  margin: 0 10px;
}
.option{
  display:flex;
  line-height: 30px;
}
.decimal{
  width: 40px !important;
  height: 32px !important;
  text-align: center;
}
</style>
</head>
<body>
  <div class="container">
    <header class="header"></header>
    <main>
    <table class="table2" id="calc">
      <tbody>
        <tr id="multi">
          <th>掛け算</th>
          <td style="display:flex;">
              <input type="input" class="input number"> 
              <div class="sign">×</div> 
              <input type="input" class="input number"> 
            </td>
            <td><div class="result"></div></td>
          </tr>
          <tr id="division">
            <th rowspan="2">割り算</th>
            <td style="display:flex;"><input type="input" class="input number">
              <div class="sign">÷</div> 
              <input type="input" class="input number"> 
            </td>
            <td><div class="result"></div></td>
          </tr>
          <tr>
            <td >
            <div class="option">(小数点 第 <input type="input" id="division_decimal" class="input decimal" value="2"> 位)</div>
            </td>
          </tr>

      </tbody>
    </table>

    <!-- kenkey -->
    <ul class="tenkey_box">
      <li >1</li>
      <li >2</li>
      <li >3</li>
      <li >4</li>
      <li >5</li>
      <li >6</li>
      <li >7</li>
      <li >8</li>
      <li >9</li>
      <li >0</li>
    </ul>
    <div class="btnBox" style="text-align: center!important;">
      <div class="btn" id="js_clear">クリア</div>
      <div class="btn -red" id="js_all_clear">全てクリア</div>
    </div>

</div><!-- main -->
</div><!-- container -->
<script src="./common/js/jquery-3.6.3.min.js"></script>
<script src="./common/js/jquery-ui.js"></script>
<script src="./common/js/common.js"></script>
<script src="./common/js/tools.js?tesat"></script>
<!-- <script src="./common/js/calc.js?tesat"></script> -->

<script>
'use strict';
$(function(){
  let i;
  let active = 'multi';
  let target_index = 0;
  let active_input = $('#'+active).find('.input').eq(target_index);
  let active_result;

  /*-----------------------
    init
  -----------------------*/
  function init(){
    active_input = $('#'+active).find('.input').eq(target_index);
    active_result = $('#'+active).find('.result');
    $('.input').removeClass('active');
    active_input.addClass('active');
  }
  init();
  active_input.focus();

/*-----------------------
  テンキー
-----------------------*/
let num
$('.tenkey_box li').click(function(){
  let n = $(this).html();
  active_input.val(active_input.val()+n);
  calc(active_input);
})
function calc(active_input){
  let input1 = $('#'+active).find('.input').eq(0).val();
  let input2 = $('#'+active).find('.input').eq(1).val();

  switch(active){
    case 'multi':   
      // 掛け算
      active_result.html(input1*input2);
      break;
    case 'division':  
      // 割り算
      if(!isFinite(input1/input2)){
        active_result.html('');
      } else{
        let keta=1;
        for(i=0; i<$('#division_decimal').val(); i++){
          keta = keta*10;
        }
        console.log($('#division_decimal').val(),keta);

            active_result.html(Math.round(input1/input2*keta)/keta);

        
      }
    break;
      
  }
}


  $('#calc').on('click', '.input', function(){
    active = $(this).parent().parent().attr('id');
    target_index = $(this).index()-1;
    if(target_index<0){
      target_index = 0;
    }
    init();
  })
/*-----------------------
  all clear
-----------------------*/
$('#js_clear').click(function(){
  active_input.val('');
  active_result.html('');
})
$('#js_all_clear').click(function(){
  $('.number').val('');
  $('.result').html('');
})
})
</script>
</body>
</html> 
